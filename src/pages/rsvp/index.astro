---
export const prerender = false;

import Navbar from "../../components/Navbar.astro";
import Layout from "../../layouts/Layout.astro";

import { getRSVPs, insertRSVP } from "../../data/db";


if (Astro.request.method === "POST") {
  const formData = await Astro.request.formData();
  console.log(formData);

  const result = await insertRSVP({ 
    firstName: "Gina",
    lastName: "Luu",
    email: "test@test.com",
    address: "10296 Bayou Oaks Dr, Conroe, TX 77385",
    phoneNumber: "5074614662",
    attendingIndia: true,
    numIndiaAttendees: 1,
    attendingHouston: true,
    numHoustonAttendees: 0,
    additionalDietaryInfo: "",
  })

  return Astro.redirect("/rsvp/success");
}
---

<Layout title="Gina & Utkarsh">
  <main class="p-4 max-w-[800px] h-[100vh] mx-auto text-center">
    <div class="w-full flex justify-center mb-10 mt-8">
      <Navbar location="RSVP" />
    </div>

    <h1 class="text-4xl font-fancy text-wedding-purple mb-8">RSVP</h1>

    <form
      method="post"
      class="text-left grid grid-cols-1 gap-2 text-wedding-purple max-w-[600px] mx-auto p-2 font-plain [&>label>input]:font-normal [&>label>input]:text-black"
    >
      <label class="block">
        <span>First name</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="firstName"
        />
      </label>
      <label class="block">
        <span>Last name</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="lastName"
        />
      </label>

      <label class="block">
        <span>Email</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="email"
        />
      </label>

      <label class="block">
        <span>Phone Number</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="phoneNumber"
        />
      </label>

      <label class="block">
        <span>Address</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="address"
        />
      </label>

      <label class="block">
        <span>Number of Attendees</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="numberOfAttendees"
        />
      </label>

      <label class="block">
        <span>Meal Options</span>
        <input
          type="text"
          class="mt-1 block w-full rounded-md bg-gray-50 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
          placeholder=""
          name="mealOptions"
        />
      </label>

      <button
        type="submit"
        class="bg-wedding-purple text-wedding-cream mt-2 p-2 rounded-md"
        >Submit</button
      >
    </form>
  </main>
</Layout>
